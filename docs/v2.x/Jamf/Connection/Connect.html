<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Jamf::Connection::Connect
  
    &mdash; ruby-jss-2.0.0a10
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Jamf::Connection::Connect";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Jamf.html" title="Jamf (module)">Jamf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Connection.html" title="Jamf::Connection (class)">Connection</a></span></span>
     &raquo; 
    <span class="title">Connect</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Jamf::Connection::Connect
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="../Connection.html" title="Jamf::Connection (class)">Jamf::Connection</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/jamf/api/connection/connect.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This module defines constants and methods used for processing the connection parameters, acquiring passwords and tokens, and creating the connection objects to the Classic and Jamf Pro APIs. It also defines the disconnection methods</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connect-instance_method" title="#connect (instance method)">#<strong>connect</strong>(url = nil, **params)  &#x21d2; String </a>
    

    
      (also: #login)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Connect to the both the Classic and Jamf Pro APIs.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#disconnect-instance_method" title="#disconnect (instance method)">#<strong>disconnect</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>With a REST connection, there isn&#39;t any real “connection” to disconnect from So to disconnect, we just unset all our credentials.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#logout-instance_method" title="#logout (instance method)">#<strong>logout</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Same as disconnect, but invalidates the token on the server first.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_refreshed_token-instance_method" title="#update_refreshed_token (instance method)">#<strong>update_refreshed_token</strong>(subcnx)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>always use the current token, which by default will auto-refresh.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_connected-instance_method" title="#validate_connected (instance method)">#<strong>validate_connected</strong>(subcnx)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>raise exception if not connected, and make sure we&#39;re using the current token.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="connect-instance_method">
  
    #<strong>connect</strong>(url = nil, **params)  &#x21d2; <tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='login-instance_method'>login</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Connect to the both the Classic and Jamf Pro APIs</p>

<p>IMPORTANT: http (non-SSL, unencrypted) connections are not allowed.</p>

<p>The first parameter may be a URL (must be https) from which the host &amp; port will be used, and if present, the user and password E.g.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_connect'>connect</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://myuser:pass@host.domain.edu:8443</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>which is the same as:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_connect'>connect</span> <span class='label'>host:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>host.domain.edu</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>port:</span> <span class='int'>8443</span><span class='comma'>,</span> <span class='label'>user:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>myuser</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>pw:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pass</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>When using a URL, other parameters below may be specified, however host: and port: parameters will be ignored, since they came from the URL, as will user: and :pw, if they are present in the URL. If the URL doesn&#39;t contain user and pw, they can be provided via the parameters, or left to default values.</p>

<p>### Passwords</p>

<p>The pw: parameter also accepts the symbols :prompt, and :<a href="X">stdin</a></p>

<p>If :prompt, the user is promted on the commandline to enter the password for the :user.</p>

<p>If :stdin, the password is read from the first line of stdin</p>

<p>If :stdinX, (where X is an integer) the password is read from the Xth line of stdin.see Jamf.stdin</p>

<p>If omitted, and running from an interactive terminal, the user is prompted as with :prompt</p>

<p>### Tokens Instead of a user and password, you may specify a valid &#39;token:&#39;, which is either:</p>

<p>A Jamf::Connection::Token object, which can be extracted from an active Jamf::Connection via its #token method</p>

<p>or</p>

<p>A valid token string e.g. “eyJhdXR…6EKoo” from any source can also be used.</p>

<p>When using an existing token or token string, the username used to create the token will be read from the server. However, if you don&#39;t also provide the users password using the pw: parameter, then the pw_fallback option will always be false.</p>

<p>### Default values</p>

<p>Any values available via JSS.config will be used if they are not provided in the parameters. See <span class='object_link'><a href="../Configuration.html" title="Jamf::Configuration (class)">Jamf::Configuration</a></span>. If there are no config values then a built-in default is used if available.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The URL to use for the connection. Must be &#39;https&#39;. The host, port, and (if provided), user and spassword will be extracted. Any of those params explicitly provided will be ignored if present in the url</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the keyed parameters for connection.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:host</span>
          <span class="type">(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the hostname of the JSS API server, required if not defined in JSS.config</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:server_path</span>
          <span class="type">(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If your JSS is not at the root of the server, e.g. if it&#39;s at</p>

<pre class="code ruby"><code class="ruby">https://myjss.myserver.edu:8443/dev_mgmt/jssweb
</code></pre>

<p>rather than</p>

<pre class="code ruby"><code class="ruby">https://myjss.myserver.edu:8443/
</code></pre>

<p>then use this parameter to specify the path below the root e.g:</p>

<pre class="code ruby"><code class="ruby">server_path: &#39;dev_mgmt/jssweb&#39;
</code></pre>
</div>
          
        </li>
      
        <li>
          <span class="name">:user</span>
          <span class="type">(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>a JSS user who has API privs, required if not defined in Jamf::CONFIG</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:pw</span>
          <span class="type">(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>, <tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The user&#39;s password, :prompt, or :stdin If :prompt, the user is promted on the commandline to enter the password If :stdin#, the password is read from a line of std in represented by the digit at #, so :stdin3 reads the passwd from the third line of standard input. Defaults to line 1, if no digit is supplied. see Jamf.stdin</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:port</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the port number to connect with, defaults to 443 for Jamf Cloud hosts, 8443 for on-prem hosts</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ssl_version</span>
          <span class="type">(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>, <tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The SSL version to use. Default is TLSv1_2</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:verify_cert</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>should SSL certificates be verified. Defaults to true.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:open_timeout</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the number of seconds to wait for an initial response, defaults to 60</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:timeout</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the number of seconds before an API call times out, defaults to 60</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:keep_alive</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Should the token for the connection for be automatically refreshed before it expires? Default is true</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:token_refresh_buffer</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If keep_alive, refresh the token this many seconds before it expires. Must be &gt;= Jamf::Connection::Token::MIN_REFRESH_BUFFER, which is the default</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:pw_fallback</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If keep_alive, should the passwd be cached in memory and used to create a new token, if there are problems with the normal token refresh process?</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>connection description, the output of #to_s</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jamf/api/connection/connect.rb', line 148</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>No url or connection parameters provided</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='comment'># reset all values, flush caches
</span>  <span class='id identifier rubyid_disconnect'>disconnect</span>

  <span class='comment'># If there&#39;s a Token object in :token, this sets @token,
</span>  <span class='comment'># and adds host, port, user from that token
</span>  <span class='id identifier rubyid_parse_token'>parse_token</span> <span class='id identifier rubyid_params'>params</span>

  <span class='comment'># Get host, port, user and pw from a URL, add to params if needed
</span>  <span class='id identifier rubyid_parse_url'>parse_url</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span>

  <span class='comment'># apply defaults from config, client, and then ruby-jss itself.
</span>  <span class='id identifier rubyid_apply_default_params'>apply_default_params</span> <span class='id identifier rubyid_params'>params</span>

  <span class='comment'># Once we&#39;re here, all params have been parsed &amp; defaulted into the
</span>  <span class='comment'># params hash, so make sure we have the minimum needed params for a connection
</span>  <span class='id identifier rubyid_verify_basic_params'>verify_basic_params</span> <span class='id identifier rubyid_params'>params</span>

  <span class='comment'># it there&#39;s no @token yet, get one from a token string or a password
</span>  <span class='id identifier rubyid_create_token_if_needed'>create_token_if_needed</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>

  <span class='comment'># We have to have a usable connection to do this, so it has to come after
</span>  <span class='comment'># all the stuff above
</span>  <span class='id identifier rubyid_verify_server_version'>verify_server_version</span>

  <span class='ivar'>@timeout</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>
  <span class='ivar'>@open_timeout</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:open_timeout</span><span class='rbracket'>]</span>

  <span class='ivar'>@connect_time</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Time.html" title="Time (class)">Time</a></span></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='ivar'>@name</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span><span class='embexpr_end'>}</span><span class='tstring_content'>@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='ivar'>@c_base_url</span> <span class='op'>=</span> <span class='id identifier rubyid_base_url'>base_url</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../../Jamf.html" title="Jamf (module)">Jamf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Connection.html" title="Jamf::Connection (class)">Connection</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#CAPI_RSRC_BASE-constant" title="Jamf::Connection::Constants::CAPI_RSRC_BASE (constant)">CAPI_RSRC_BASE</a></span></span>
  <span class='ivar'>@jp_base_url</span> <span class='op'>=</span> <span class='id identifier rubyid_base_url'>base_url</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../../Jamf.html" title="Jamf (module)">Jamf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Connection.html" title="Jamf::Connection (class)">Connection</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#JPAPI_RSRC_BASE-constant" title="Jamf::Connection::Constants::JPAPI_RSRC_BASE (constant)">JPAPI_RSRC_BASE</a></span></span>

  <span class='comment'># the faraday connection objects
</span>  <span class='ivar'>@c_cnx</span> <span class='op'>=</span> <span class='id identifier rubyid_create_classic_connection'>create_classic_connection</span>
  <span class='ivar'>@jp_cnx</span> <span class='op'>=</span> <span class='id identifier rubyid_create_jp_connection'>create_jp_connection</span>

  <span class='ivar'>@connected</span> <span class='op'>=</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="disconnect-instance_method">
  
    #<strong>disconnect</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>With a REST connection, there isn&#39;t any real “connection” to disconnect from So to disconnect, we just unset all our credentials.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218
219
220
221
222
223
224
225
226
227
228
229</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jamf/api/connection/connect.rb', line 216</span>

<span class='kw'>def</span> <span class='id identifier rubyid_disconnect'>disconnect</span>
  <span class='id identifier rubyid_flushcache'>flushcache</span>
  <span class='ivar'>@token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_stop_keep_alive'>stop_keep_alive</span>

  <span class='ivar'>@connect_time</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@jp_cnx</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@c_cnx</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@c_base_url</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@jp_base_url</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@server_path</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@token</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@connected</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='symbol'>:disconnected</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="logout-instance_method">
  
    #<strong>logout</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Same as disconnect, but invalidates the token on the server first</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235
236</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jamf/api/connection/connect.rb', line 233</span>

<span class='kw'>def</span> <span class='id identifier rubyid_logout'>logout</span>
  <span class='ivar'>@token</span><span class='op'>&amp;.</span><span class='id identifier rubyid_invalidate'>invalidate</span>
  <span class='id identifier rubyid_disconnect'>disconnect</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_refreshed_token-instance_method">
  
    #<strong>update_refreshed_token</strong>(subcnx)  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>always use the current token, which by default will auto-refresh</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


204
205
206
207
208</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jamf/api/connection/connect.rb', line 204</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_refreshed_token'>update_refreshed_token</span><span class='lparen'>(</span><span class='id identifier rubyid_subcnx'>subcnx</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_subcnx'>subcnx</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Authorization</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bearer </span><span class='embexpr_beg'>#{</span><span class='ivar'>@token</span><span class='period'>.</span><span class='id identifier rubyid_token'>token</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_subcnx'>subcnx</span><span class='period'>.</span><span class='id identifier rubyid_authorization'>authorization</span> <span class='symbol'>:Bearer</span><span class='comma'>,</span> <span class='ivar'>@token</span><span class='period'>.</span><span class='id identifier rubyid_token'>token</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_connected-instance_method">
  
    #<strong>validate_connected</strong>(subcnx)  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>raise exception if not connected, and make sure we&#39;re using the current token</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../InvalidConnectionError.html" title="Jamf::InvalidConnectionError (class)">Jamf::InvalidConnectionError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


196
197
198
199
200
201</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/jamf/api/connection/connect.rb', line 196</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_connected'>validate_connected</span><span class='lparen'>(</span><span class='id identifier rubyid_subcnx'>subcnx</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_using_dft'>using_dft</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Jamf.cnx</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='kw'>self</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../../Jamf.html" title="Jamf (module)">Jamf</a></span></span><span class='period'>.</span><span class='id identifier rubyid_cnx'><span class='object_link'><a href="DefaultConnection.html#cnx-instance_method" title="Jamf::Connection::DefaultConnection#cnx (method)">cnx</a></span></span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../Jamf.html" title="Jamf (module)">Jamf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../InvalidConnectionError.html" title="Jamf::InvalidConnectionError (class)">InvalidConnectionError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Connection &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; Not Connected. Use </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_using_dft'>using_dft</span><span class='embexpr_end'>}</span><span class='tstring_content'>.connect first.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_connected?'>connected?</span>

  <span class='id identifier rubyid_update_refreshed_token'>update_refreshed_token</span><span class='lparen'>(</span><span class='id identifier rubyid_subcnx'>subcnx</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Apr 20 17:10:12 2022 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.6.3).
</div>

    </div>
  </body>
</html>